<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recuperar contraseña</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="bg-white shadow-xl rounded-2xl w-full max-w-md p-8">
        <div class="flex items-center justify-center mb-6">
            <img src="img/LOGO_CS.jpg" alt="Logo" class="w-16 h-16 rounded-full mr-3">
            <h2 class="text-2xl font-bold text-gray-800">Recuperar contraseña</h2>
        </div>

        <p class="text-center text-gray-500 mb-6 text-sm">
            Ingresa tu correo y te enviaremos un enlace para recuperar tu cuenta.
        </p>

        <form id="recoverForm">
            <label class="block mb-2 text-gray-700 font-medium" for="email">Correo electrónico</label>
            <input id="email" name="email" type="email" placeholder="ejemplo@correo.com"
                class="w-full p-3 border border-gray-300 focus:border-blue-600 focus:ring-2 focus:ring-blue-300 outline-none rounded-lg mb-4"
                required />

            <button id="sendBtn" type="submit"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg font-semibold transition duration-200">
                Enviar enlace
            </button>
        </form>

        <div class="mt-4">
            <button id="resendBtn" type="button" class="w-full bg-blue-400 text-white py-2 rounded-lg font-semibold transition duration-200 hidden" disabled>
                Reenviar código (60s)
            </button>
        </div>

        <div class="text-center mt-4">
            <p id="statusMsg" class="text-sm text-green-600 hidden">Se ha enviado un enlace a tu correo.</p>
        </div>

        <div class="flex items-center justify-between mt-6">
            <a href="login.html" class="text-sm text-blue-600 hover:underline">Volver a iniciar sesión</a>
            <a href="Index.html" class="text-sm text-gray-500 hover:underline">Volver al inicio</a>
        </div>

        <p class="text-xs text-gray-400 mt-4 text-center">Si no recibes el correo en 1-5 minutos, revisa la carpeta de spam.</p>
    </div>

    <footer class="absolute bottom-6 text-center w-full text-sm text-gray-500">© <span id="year"></span> Círculo Seguro</footer>

    <script>
      // Establecer año actual en el footer
      document.getElementById('year').textContent = new Date().getFullYear();

      // Lógica para mostrar botón de reenvío con temporizador de 60s
      (function(){
        const form = document.getElementById('recoverForm');
        const sendBtn = document.getElementById('sendBtn');
        const resendBtn = document.getElementById('resendBtn');
        const statusMsg = document.getElementById('statusMsg');
        const DURATION = 60; // segundos
        let intervalId = null;

        function startTimer() {
          let remaining = DURATION;
          resendBtn.classList.remove('hidden');
          resendBtn.disabled = true;
          resendBtn.textContent = `Reenviar código (${remaining}s)`;
          resendBtn.classList.remove('opacity-60');

          intervalId = setInterval(() => {
            remaining -= 1;
            if (remaining > 0) {
              resendBtn.textContent = `Reenviar código (${remaining}s)`;
            } else {
              clearInterval(intervalId);
              intervalId = null;
              resendBtn.textContent = 'Reenviar código';
              resendBtn.disabled = false;
            }
          }, 1000);
        }

        function onSend(e){
          e.preventDefault();
          // Mostrar mensaje de confirmación (simulado)
          statusMsg.classList.remove('hidden');
          // Deshabilitar el botón enviar para evitar múltiples envíos
          sendBtn.disabled = true;
          sendBtn.classList.add('opacity-60','cursor-not-allowed');
          // Iniciar temporizador para reenvío
          if(intervalId) { clearInterval(intervalId); intervalId = null; }
          startTimer();
          // Aquí iría la llamada real al servidor para enviar el correo
        }

        function onResend(){
          // Simular reenvío: volver a deshabilitar y reiniciar contador
          resendBtn.disabled = true;
          resendBtn.classList.add('opacity-60');
          statusMsg.classList.remove('hidden');
          if(intervalId) { clearInterval(intervalId); intervalId = null; }
          startTimer();
          // Aquí iría la llamada real al servidor para reenviar el correo
        }

        form.addEventListener('submit', onSend);
        resendBtn.addEventListener('click', onResend);
      })();
    </script>

    <script src="/Views/Js/RestaurarCuenta.js"></script>
</body>

</html>